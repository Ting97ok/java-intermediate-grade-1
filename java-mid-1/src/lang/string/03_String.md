# 3. String

- 문자열 타입 : char, String
    - 여러 문자를 사용하기 위해서는 char를 나열 → 불편
        - 그래서 String을 통해 문자열 나열 가능
    - String은 클래스 → 그러므로 int, boolean 과 같이 기본형이 아닌 참조형 → 참조값만 들어갈 수 있음
        - but, 문자열은 매우 자주 사용됨 → 그냥 “” 으로 감싸면 자바에서 new String(””) 으로 변경해줌
    - String 클래스의 내부를 보면 char[] 로 문자열의 배열로 구성
        - 다만 자바 9 부터는 char[] 가 아닌 byte[] 로 구성되어있는데 그 이유는 char는 2 바이트 → 메모리 비효율 / 영어나 숫자는 1 바이트 이므로 byte[] 로 사용하면 메모리 구성이 효율적
    - 주요 메서드
        - length() : 문자열의 길이를 반환한다.
        - charAt(int index) : 특정 인덱스의 문자를 반환한다.
        - substring(int beginIndex, int endIndex) : 문자열의 부분 문자열을 반환한다.
        - indexOf(String str) : 특정 문자열이 시작되는 인덱스를 반환한다.
        - toLowerCase(), toUpperCase() : 문자열을 소문자 또는 대문자로 변환한다.
        - trim() : 문자열 양 끝의 공백을 제거한다.
        - concat(String str) : 문자열을 더한다.
    - String 클래스, 참조형
        - String은 클래스이다 → 기본형 X / 참조형 O
            - 즉 원칙적으로 + 연산이 불가하고 concat 과 같은 메서드를 사용해야함 → 그러나 문자열은 너무 자주 사용되기 때문에 자바에서 + 를 제공함.
- String 비교
    - String 비교할 때는 동일성(==) 이 아닌 동등성 (equals)로 비교해야함.
        - String은 기본적으로 new String(””) 로 생성되기 때문에 동일성으로 비교하면 false로 나옴.
    - 다만 “” 와 같이 문자열 리터럴로 생성한 String은 메모리 효율성과 성능 최적화를 위해 문자열 풀을 사용한다. 이 경우에는 동일성 비교(==)를 하더라도 true로 반환한다.
        - String 객체를 생성할 때 문자열 풀에 저장한 후 필요할때 재사용이 가능하다. 이 경우 불필요한 객체를 생성 또는 제거할 필요가 없으므로 성능과 메모리의 최적화를 할 수 있다. 문자열 풀은 힙 영역을 사용하고 해시 알고리즘을 사용하기 때문에 매우 빠르게 찾을 수 있다. → 해시 알고리즘은 나중에 ㅋ
    - String을 비교할 때 new String() 으로 만들어진 것인지 문자열 리터럴로 만들어진것인지 모르므로 == 비교가 아닌 equals 비교를 해야한다.
- String 불변
    - String은 기본적으로 불변이다. 즉 concat 와 같은 메소드를 사용하더라도 리턴값을 반환해야 해당 값을 출력할 수 있다.
        - 불변으로 설계된 이유는 문자열 리터럴은 문자열 풀을 통해 최적화를 하는데 이 값이 변경되어 버리면 해당 참조값을 참조하는 모든 String이 변경되어버린다. → 사이드 이펙트 발생
- String 가변
    - String은 불변이다. 즉 String + String을 하면 새로운 String이 반환되어야한다.
        - 이러한 방식은 여러개의 String이 + 연산을 하게 되면 새로운 String이 생기고 최종적으로 생긴 String이외의 중간에 생긴 String은 GC해야한다. → 즉 문자열을 더 자주 변경할수록 시스템의 자원을 더 소모한다.
    - 이럴경우 String builder를 사용하면 되는데 String builder는 가변형이므로 새로운 값을 반환하지 않고 값 변경이 가능하다.
        - String builder 는 가변형이므로 사이드 이펙트에 주의해야함 → 그래서 보통 String builder를 사용하고 마지막에 toString을 통해 불변인 String으로 변환함.
    - String builder 메서드
        - append() : 메서드를 사용해 여러 문자열을 추가한다.
        - insert() : 메서드로 특정 위치에 문자열을 삽입한다.
        - delete() : 메서드로 특정 범위의 문자열을 삭제한다.
        - reverse() : 메서드로 문자열을 뒤집는다.
- String 최적화
    - 자바 컴파일러는 문자열 리터럴의 더하는 부분을 최적화해준다.
        - 단순 문자열인 경우 결합을 컴파일 시점에 해주기 때문에 런타임에 수행하지 않아 성능이 향상된다.
        - String 변수의 경우에는 어떤 문자열인지 모르므로 String builder를 통해 최적화를 진행 후 마지막에 toString을 통해 가변으로 변경해준다.
            - 즉 자바에서 String builder를 통해 최적화를 진행해주기 때문에 대부분의 경우에는 + 만 사용하면 된다.
    - 다만 for 문 과 같이 반복문에서 String 의 + 연산을 사용하는 경우 String builder 에 toString을 사용해야하기 때문에 최적화가 일어나지 않는다. → 불변인 String의 연산으로 String builder를 반복문만큼 생성해야하기 때문
        - 그러므로 이 경우에는 String builder 직접 사용한 후 반복문을 사용하면 바로 변경이 가능하기때문에 메모리 성능 누수가 적어진다. → 물론 마지막에는 불변인 String으로 변경해야한다.
    - String builder 를 사용하는게 더 좋은 경우
        - 반복문에서 반복해서 문자를 연결할 때
        - 조건문을 통해 동적으로 문자열을 조합할 때
        - 복잡한 문자열의 특정 부분을 변경해야 할 때
        - 매우 긴 대용량 문자열을 다룰 때
    - String builder VS String buffer
        - String builder는 빠른 대신 동기화 오버헤드가 없으므로 멀티 쓰레드 상황에 안전하지 않다.
        - String buffer는 동기화 오버헤드가 있으므로 멀티 쓰레드 상황에 안전하지만 느리다.
- String builder 메서드 체인 기법
    - String builder는 메서드 체인 기법을 사용한다.
        - 메서드 체인 기법은 메서드 호출 할 때 return 을 나 자신으로 하는것이다. 즉 여러 메서드 호출을 한번에 할 수 있다.